define("js/ci_tenlotterys",["jquery"],function(e){"user strict";var t=e("jquery"),i={index:-1,count:0,timer:100,speed:20,times:0,cycle:50,prize:-1,init:function(e){t("#"+e).find(".reglot_unit").length>0&&($lottery=t("#"+e),$units=$lottery.find(".reglot_unit"),this.obj=$lottery,this.count=$units.length,$lottery.find(".reglot-unit-"+this.index).addClass("active"))},roll:function(){var e=this.index,i=this.count,n=this.obj;return t(n).find(".reglot-unit-"+e).removeClass("active"),e+=1,e>i-1&&(e=0),t(n).find(".reglot-unit-"+e).addClass("active"),this.index=e,!1},stop1:function(e){return this.prize=e,!1},open:function(e){t("#reglot_mask").show(),t("#reglot_mask .reglot_m_title div.reglotImg img").attr("src",e)},openu:function(e){t(".reglot_popmenu").show(),t(".reglot_popmenu .reglot_m_title div").html(e)}},n=!1;window.onload=function(){i.init("tenlotery_box"),t("#tenlotery_box a").click(function(){t.ajax({type:"POST",url:cid_url+"/api/wx_activity/handle_l",data:{lid:13},dataType:"json",success:function(e){function t(){if(i.times+=1,i.roll(),i.times>i.cycle+10&&i.prize==i.index)clearTimeout(i.timer),i.open(e.img),i.prize=-1,i.times=0,n=!1;else{if(i.times<i.cycle)i.speed-=10;else if(i.times==i.cycle){Math.random()*i.count|0;i.prize=e.rank}else i.times>i.cycle+10&&(0==i.prize&&7==i.index||i.prize==i.index+1)?i.speed+=110:i.speed+=20;i.speed<40&&(i.speed=40),i.timer=setTimeout(t,i.speed)}return!1}if(401===e.code)shellmodule.login(e.message);else{if(402!==e.code)return n?!1:(i.speed=100,t(),n=!0,!1);-2==e.rank?showmsg(e.message,"",1e3):-1==e.rank&&i.open(e.img)}},error:function(){showmsg("返回异常")}})}),t(".reglog_btn_certain").click(function(){t(this).parents("#reglot_mask").hide(),window.location.reload()})}});