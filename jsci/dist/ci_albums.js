define("js/ci_album",["jquery","swiper"],function(t){"user strict";function a(t){for(;t&&"undefined"!=typeof t.originalEvent;)t=t.originalEvent;return t}var s=t("jquery"),o=(t("swiper"),s("#postalbumid").attr("data-tid"));s(".posta_ok").on("click",function(){var t,a,o,e,i,r,n=s(this).attr("data-url");for(o=n.length,a=0,t="";o>a;){if(e=255&n.charCodeAt(a++),a==o){t+=base64EncodeChars.charAt(e>>2),t+=base64EncodeChars.charAt((3&e)<<4),t+="==";break}if(i=n.charCodeAt(a++),a==o){t+=base64EncodeChars.charAt(e>>2),t+=base64EncodeChars.charAt((3&e)<<4|(240&i)>>4),t+=base64EncodeChars.charAt((15&i)<<2),t+="=";break}r=n.charCodeAt(a++),t+=base64EncodeChars.charAt(e>>2),t+=base64EncodeChars.charAt((3&e)<<4|(240&i)>>4),t+=base64EncodeChars.charAt((15&i)<<2|(192&r)>>6),t+=base64EncodeChars.charAt(63&r)}if(isIOS)window.location.href="ios://NativeSaveImage/"+t;else if(isAndroid)try{window.Android.NativeSaveImage(t)}catch(c){console.log(c),showmsg("此版本不支持，请安装最新版本","",2e3)}else showmsg("此版本只支持app保存","",2e3);return!1}),function(){function t(t,a,s,o){if(t[0]){a=a||1,s=s||0,o=o||0,t.css("-webkit-transform","scale("+a+")"),t.css("-moz-transform","scale("+a+")"),t.css("-o-transform","scale("+a+")"),t.css("transform","scale("+a+")");var e=t.parent(),i=(r?"translate3d":"translate")+"("+s*a+"px, "+o*a+"px"+(r?", 0px)":")");e.css("-webkit-transform",i),e.css("-moz-transform",i),e.css("-o-transform",i),e.css("transform",i)}}function e(a){var o=a.offset(),e=a.width()*g-h,i=a.height()*g-m;if(i>0){var r=o.top-s(".postalbum").offset().top;r>0?x-=r/g:r+a.height()*g-m<0&&(x-=(r+a.height()*g-m)/g)}else x=0;e>0?o.left>0?_-=o.left/g:o.left+a.width()*g-h<0&&(_-=(o.left+a.width()*g-h)/g):_=0,1>g&&(g=1),w=_,v=x,t(a,g,_,x)}function i(t){return s(".postalbum_c").css("-webkit-transform","translate3d("+t+"px, 0, 0)"),s(".postalbum_c").css("-moz-transform","translate3d("+t+"px, 0, 0)"),s(".postalbum_c").css("-o-transform","translate3d("+t+"px, 0, 0)"),s(".postalbum_c").css("transform","translate3d("+t+"px, 0, 0)"),!0}for(var r=("WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix),n=rentnum,c=s(".postalbum_c li").length,l=[],u=0;c>u;u++)l[u]=(new Image).src=s(".postalbum_c").find("img").eq(u).attr("zsrc");var h=document.body.clientWidth||window.innerWidth,m=document.documentElement.clientHeight;s(".postalbum").css({display:"block",height:m+"px"}),s(".postalbum_u").css({height:m+"px",width:h+"px"}),s(".postalbum_i").css({"max-height":"100%",visibility:"visible"}),r?(s(".postalbum_c").css({"line-height":m+"px",width:h*c+"px"}),i("-"+n*h)):(s(".postalbum_c").css({display:"block",height:m*c+"px"}),s(".postalbum_c").css({top:"-"+n*m+"px"}));var p={},d=!0,f=null;touchaction=function(t,s,o){t.on("touchstart",s,function(t){t=a(t),p.x1=t.touches[0].pageX,p.y1=t.touches[0].pageY,p.hori=!0,d=!0}).on("touchmove",s,function(t){d=!1,t=a(t),p.x2=t.touches[0].pageX,p.y2=t.touches[0].pageY,p.distx=p.x2-p.x1,p.disty=p.y2-p.y2,Math.abs(p.distx)<2*Math.abs(p.disty)?p.hori=!1:t.preventDefault()}).on("touchend",s,function(t){if(t=a(t),p.x2&&Math.abs(p.distx)>30&&p.hori&&!d){var s=p.distx>0?"right":"left";o.call(this,s,t)}else d&&(postalbum_touch_interval=(new Date).getTime(),f||(f=setTimeout(function(){var a=(new Date).getTime()-postalbum_touch_interval;a>=250&&o.call(this,"tap",t),postalbum_touch_interval=0,f=null},250)))})};var b=s("#img_"+n);b.css({"-webkit-transition":"all 200ms","-moz-transition":"all 200ms","-o-transition":"all 200ms",transition:"all 200ms"}),t(b,1,0,0),setTimeout(function(){e(b)},350);var g=1,_=0,x=0,w=0,v=0,y=!1,k=0,A=null,C={};s(".postalbum_u").on("touchstart",".postalbum_i",function(t){y&&(t=a(t),C.x1=t.touches[0].pageX,C.y1=t.touches[0].pageY)}).on("touchmove",".postalbum_i",function(o){y&&(o=a(o),C.x2=o.touches[0].pageX,C.y2=o.touches[0].pageY,C.distx=C.x2-C.x1,C.disty=C.y2-C.y1,w=C.distx/g+_,v=C.disty/g+x,t(s("#img_"+n),g,w,v))}).on("touchend",".postalbum_i",function(a){k=(new Date).getTime(),A||(A=setTimeout(function(){var a=(new Date).getTime()-k,o=s("#img_"+n);250>a?(g=1==g?2:1,y=1==g?!1:!0,y&&o.attr("src",o.attr("orig")),t(o,g,w,v),setTimeout(function(){e(o)},250)):y&&(_=w,x=v,e(o)),k=0,A=null},250))});touchaction(s(".postalbum"),".postalbum_u",function(t,a){if(!y)switch(t){case"left":if(n>=c-1)return!1;for(var e=0;3>e;e++)s("#img_"+(n+e)).attr("src")||s("#img_"+(n+e)).attr("src",s("#img_"+(n+e)).attr("zsrc"));s(".posta_ok").attr("data-url",l[n+1]),n++,r?i("-"+n*h):s(".postalbum_c").css({top:"-"+n*m+"px"}),s("#curpic").text(n+1);break;case"right":if(0>=n)return!1;for(var e=-3;0>e;e++)s("#img_"+(n+e)).attr("src")||s("#img_"+(n+e)).attr("src",s("#img_"+(n+e)).attr("zsrc"));s(".posta_ok").attr("data-url",l[n-1]),n--,r?i("-"+n*h):s(".postalbum_c").css({top:"-"+n*m+"px"}),s("#curpic").text(n+1);break;case"tap":s(".postalbum_h");isIOS?window.location.href="ios://NativeBack":isAndroid?window.Android.NativeBack():window.location.href=cid_url+"/api/show/?tid="+o}})}()});