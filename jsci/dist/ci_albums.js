define("js/ci_album",["jquery","swiper"],function(t){"user strict";function a(t){for(;t&&"undefined"!=typeof t.originalEvent;)t=t.originalEvent;return t}var s=t("jquery"),e=(t("swiper"),s("#postalbumid").attr("data-tid"));s(".posta_ok").on("click",function(){var t,a,e,i,o,r,n=s(this).attr("data-url");for(e=n.length,a=0,t="";e>a;){if(i=255&n.charCodeAt(a++),a==e){t+=base64EncodeChars.charAt(i>>2),t+=base64EncodeChars.charAt((3&i)<<4),t+="==";break}if(o=n.charCodeAt(a++),a==e){t+=base64EncodeChars.charAt(i>>2),t+=base64EncodeChars.charAt((3&i)<<4|(240&o)>>4),t+=base64EncodeChars.charAt((15&o)<<2),t+="=";break}r=n.charCodeAt(a++),t+=base64EncodeChars.charAt(i>>2),t+=base64EncodeChars.charAt((3&i)<<4|(240&o)>>4),t+=base64EncodeChars.charAt((15&o)<<2|(192&r)>>6),t+=base64EncodeChars.charAt(63&r)}if(isIOS)window.location.href="ios://NativeSaveImage/"+t;else{if(!isAndroid)return!1;window.Android.NativeSaveImage(t)}return!1}),function(){function t(t,a,s,e){if(t[0]){a=a||1,s=s||0,e=e||0,t.css("-webkit-transform","scale("+a+")"),t.css("-moz-transform","scale("+a+")"),t.css("-o-transform","scale("+a+")"),t.css("transform","scale("+a+")");var i=t.parent(),o=(r?"translate3d":"translate")+"("+s*a+"px, "+e*a+"px"+(r?", 0px)":")");i.css("-webkit-transform",o),i.css("-moz-transform",o),i.css("-o-transform",o),i.css("transform",o)}}function i(a){var e=a.offset(),i=a.width()*g-h,o=a.height()*g-m;if(o>0){var r=e.top-s(".postalbum").offset().top;r>0?x-=r/g:r+a.height()*g-m<0&&(x-=(r+a.height()*g-m)/g)}else x=0;i>0?e.left>0?_-=e.left/g:e.left+a.width()*g-h<0&&(_-=(e.left+a.width()*g-h)/g):_=0,1>g&&(g=1),w=_,v=x,t(a,g,_,x)}function o(t){return s(".postalbum_c").css("-webkit-transform","translate3d("+t+"px, 0, 0)"),s(".postalbum_c").css("-moz-transform","translate3d("+t+"px, 0, 0)"),s(".postalbum_c").css("-o-transform","translate3d("+t+"px, 0, 0)"),s(".postalbum_c").css("transform","translate3d("+t+"px, 0, 0)"),!0}for(var r=("WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix),n=rentnum,c=s(".postalbum_c li").length,u=[],l=0;c>l;l++)u[l]=(new Image).src=s(".postalbum_c").find("img").eq(l).attr("zsrc");var h=document.body.clientWidth||window.innerWidth,m=document.documentElement.clientHeight;s(".postalbum").css({display:"block",height:m+"px"}),s(".postalbum_u").css({height:m+"px",width:h+"px"}),s(".postalbum_i").css({"max-height":"100%",visibility:"visible"}),r?(s(".postalbum_c").css({"line-height":m+"px",width:h*c+"px"}),o("-"+n*h)):(s(".postalbum_c").css({display:"block",height:m*c+"px"}),s(".postalbum_c").css({top:"-"+n*m+"px"}));var p={},d=!0,f=null;touchaction=function(t,s,e){t.on("touchstart",s,function(t){t=a(t),p.x1=t.touches[0].pageX,p.y1=t.touches[0].pageY,p.hori=!0,d=!0}).on("touchmove",s,function(t){d=!1,t=a(t),p.x2=t.touches[0].pageX,p.y2=t.touches[0].pageY,p.distx=p.x2-p.x1,p.disty=p.y2-p.y2,Math.abs(p.distx)<2*Math.abs(p.disty)?p.hori=!1:t.preventDefault()}).on("touchend",s,function(t){if(t=a(t),p.x2&&Math.abs(p.distx)>30&&p.hori&&!d){var s=p.distx>0?"right":"left";e.call(this,s,t)}else d&&(postalbum_touch_interval=(new Date).getTime(),f||(f=setTimeout(function(){var a=(new Date).getTime()-postalbum_touch_interval;a>=250&&e.call(this,"tap",t),postalbum_touch_interval=0,f=null},250)))})};var b=s("#img_"+n);b.css({"-webkit-transition":"all 200ms","-moz-transition":"all 200ms","-o-transition":"all 200ms",transition:"all 200ms"}),t(b,1,0,0),setTimeout(function(){i(b)},350);var g=1,_=0,x=0,w=0,v=0,y=!1,k=0,A=null,C={};s(".postalbum_u").on("touchstart",".postalbum_i",function(t){y&&(t=a(t),C.x1=t.touches[0].pageX,C.y1=t.touches[0].pageY)}).on("touchmove",".postalbum_i",function(e){y&&(e=a(e),C.x2=e.touches[0].pageX,C.y2=e.touches[0].pageY,C.distx=C.x2-C.x1,C.disty=C.y2-C.y1,w=C.distx/g+_,v=C.disty/g+x,t(s("#img_"+n),g,w,v))}).on("touchend",".postalbum_i",function(a){k=(new Date).getTime(),A||(A=setTimeout(function(){var a=(new Date).getTime()-k,e=s("#img_"+n);250>a?(g=1==g?2:1,y=1==g?!1:!0,y&&e.attr("src",e.attr("orig")),t(e,g,w,v),setTimeout(function(){i(e)},250)):y&&(_=w,x=v,i(e)),k=0,A=null},250))});touchaction(s(".postalbum"),".postalbum_u",function(t,a){if(!y)switch(t){case"left":if(n>=c-1)return!1;for(var i=0;3>i;i++)s("#img_"+(n+i)).attr("src")||s("#img_"+(n+i)).attr("src",s("#img_"+(n+i)).attr("zsrc"));s(".posta_ok").attr("data-url",u[n+1]),n++,r?o("-"+n*h):s(".postalbum_c").css({top:"-"+n*m+"px"}),s("#curpic").text(n+1);break;case"right":if(0>=n)return!1;for(var i=-3;0>i;i++)s("#img_"+(n+i)).attr("src")||s("#img_"+(n+i)).attr("src",s("#img_"+(n+i)).attr("zsrc"));s(".posta_ok").attr("data-url",u[n-1]),n--,r?o("-"+n*h):s(".postalbum_c").css({top:"-"+n*m+"px"}),s("#curpic").text(n+1);break;case"tap":s(".postalbum_h");isIOS?window.location.href="ios://NativeBack":isAndroid?window.Android.NativeBack():window.location.href=cid_url+"/api/show/?tid="+e}})}()});