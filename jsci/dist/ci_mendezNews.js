define("js/ci_mendezNew",["jquery"],function(a){"user strict";var $=a("jquery"),mentComm=$(".DetailComment");mentComm.on({click:function(){var a=$(this),e=parseInt($(this).data("commentid"));$.ajax({type:"GET",url:cid_url+"/mendez_do/zan",data:{comment_id:e},dataType:"json",cache:!1,success:function(e){e&&(200==e.code?(a.addClass("zans-hover"),a.find("em").text(parseInt(a.find("em").text())+1),showmsg(e.message,"",1e3)):showmsg(e.message,"",1e3))},error:function(){showmsg("数据返回异常！","",1e3)}})}},".paire_zg");var newComment=$("#newCommnet");$("#postsubreplay").on("click",function(){var a=$("#replymessage");$.ajax({type:"POST",url:cid_url+"/mendez_do/comment",data:{relation_id:fig.report_id,comment:a.val(),token:fig.token},dataType:"json",cache:!1,success:function(e){if(e)if(401==e.code)shellmodule.login(e.message);else if(200==e.code){showmsg(e.message,"",1e3),a.val("");var t='<div class="chment cl"><div class="viewhd webox"><div class="avatar_img"><a href="javascript:;"><img src="'+e.data.avatar+'" class="img_noerror"></a></div><div class="auth_wrap"><div class="authi_top"><a href="javascript:;" rel="nofollow" class="look_at">。。。</a><a href="javascript:void(0);" class="elecnation_dr">'+e.data.username+'</a><a href="javascript:void(0);" class="icon-zans paire_zg" data-commentid="'+e.data.comment_id+'"><em>'+e.data.zan+'</em></a><div class="popOver"><a href="javascript:void(0)" class="replayCom" data-commentid="'+e.data.comment_id+'" data-name="'+e.data.username+'">回复</a><a href="javascript:void(0)" class="repotation">举报</a></div></div><div class="authi_p"><span>'+e.data.dateline_desc+'</span></div><div class="message">'+e.data.comment+"</div></div></div></div>";if(newComment.find(".CommentList").length>0)newComment.find(".CommentList").prepend(t);else{var s='<div class="Commenthd">最新评论</div>';s+='<div class="CommentList">'+t+"</div>",newComment.append(s)}var i=$("#newCommnet").offset().top;scrollTo(0,i)}else showmsg(e.message,"",1e3)},error:function(){showmsg("数据返回异常！","",1e3)}})}),mentComm.on({click:function(a){var e=a.target;$(".DetailComment").find(".popOver").hide(200),$(this).parent(".authi_top").find(".popOver").show(200),document.addEventListener("touchmove",function(a){"block"==$(e).parent().find(".popOver").css("display")&&$(e).parent().find(".popOver").hide(200)},!1)}},".look_at");var commid;mentComm.on({click:function(){$(this);commid=parseInt($(this).data("commentid"));var a=$(this).attr("data-name");$("#postsubreplay").css("display","none"),$("#postreplays").css("display","block"),$("#replymessage").attr("placeholder","回复："+a),$("#replymessage").focus()}},".replayCom"),$("#postreplays").on("click",function(){var a=$("#replymessage");$.ajax({type:"POST",url:cid_url+"/mendez_do/comment",data:{relation_id:fig.report_id,parent_id:commid,comment:a.val(),token:fig.token},dataType:"json",cache:!1,success:function(a){401==a.code?shellmodule.login(a.message):200==a.code?(showmsg(a.message,"",1e3),setTimeout(function(){window.location.reload()})):showmsg(a.message,"",1e3)},error:function(){showmsg("数据返回异常！","",1e3)}})}),mentComm.on({click:function(){showmsg("举报成功","",1e3)}},".repotation"),$("#repliesBtn").click(function(){var a=$("#hotCommnet").offset().top;scrollTo(0,a)});var endid;if(document.getElementById("Newsloading")){endid=parseInt($("#Newsloading").attr("endid"));var flag=!0,loading=!1;$(window).scroll(function(){$(document).height()-$(this).scrollTop()-$(this).height()<200&&document.getElementById("Newsloading")&&(flag=!0,document.getElementById("Newsloading").style.display="block",setTimeout(function(){flag&&$.ajax({type:"GET",url:location.href,data:{endid:endid},dataType:"json",cache:!1,success:function(data){$("#Newsloading").hide();for(var count=data.data.comment_list.length,arr=eval(data.data.comment_list),i=0;count>i;i++){var html='<div class="chment cl"><div class="viewhd webox">';if(html+='<div class="avatar_img"><a href="javascript:;"><img src="'+arr[i].avatar+'" class="img_noerror"></a></div>',html+='<div class="auth_wrap">',html+='<div class="authi_top">',html+='<a href="javascript:;" rel="nofollow" class="look_at">。。。</a>',html+='<a href="javascript:void(0);" class="elecnation_dr">'+arr[i].username+"</a>",html+='<a href="javascript:void(0);" class="icon-zans paire_zg" data-commentid="'+arr[i].comment_id+'"><em>'+arr[i].zan+"</em></a>",html+='<div class="popOver"><a href="javascript:void(0)" class="replayCom" data-commentid="'+arr[i].comment_id+'" data-name="'+arr[i].username+'">回复</a><a href="javascript:void(0)" class="repotation">举报</a></div>',html+="</div>",html+='<div class="authi_p"><span>'+arr[i].dateline_desc+"</span></div>",html+='<div class="message">'+arr[i].comment+"</div>",arr[i].child_list.length){var brr=eval(arr[i].child_list),b_count=brr.length;html+='<div class="reply_cont">';for(var j=0;b_count>j;j++)html+='<div class="repCont"><div class="repHead"><p class="rep_nor">'+brr[j].username+"<em>"+brr[j].dateline_desc+'</em></p><a href="javascript:void(0);" class="icon-zans paire_zg" data-commentid="'+brr[j].comment_id+'"><em>'+brr[j].zan+'</em></a></div><p class="message">'+brr[j].comment+"</p></div>";html+="</div>"}html+="</div>",html+="</div></div>",$("#newCommnet .CommentList").append(html)}endid=data.data.end_id,0==endid&&$("#Newsloading").remove()},error:function(){showmsg("数据返回异常","",1e3)}}),flag=!1},1e3))})}});