define("test/register_create",["jquery","ajaxupload","common","validate"],function(e,t,o){"user strict";var n,r=e("jquery"),a=e("common"),i=(e("ajaxupload"),e("validate")),c={},l=60;c.init=function(){r("#btnSendCode").click(function(){r("#err-msg").html("");var e=r("#phone").val();return i.isEmpty(e)?void r("#err-msg").html("<i>!</i>请输入手机号码"):i.isMobile(e)?void r.ajax({type:"POST",url:homeUrl+"create/exec_step_1",data:{phone:e},cache:!1,timeout:1e4,dataType:"json",success:function(e){200==e.code?(r("#token").val(e.data),r("#btnSendCode").attr("disabled","true"),r("#btnSendCode").val(l+"'"),n=window.setInterval(c.set_remain_time,1e3)):r("#err-msg").html("<i>!</i>"+e.err)},error:function(){a.showmsg("数据返回异常，稍后再试","",1e3)}}):void r("#err-msg").html("<i>!</i>无效的手机号码")}),r("#next_step").click(function(){var e=r("#token").val(),t=r("#verify_code").val(),o=r("#invite_code").val();return i.isEmpty(t)?void r("#err-yzm").html("<i>!</i>请输入验证码"):void r.ajax({url:homeUrl+"create/exec_step_2",type:"post",dataType:"json",data:"token="+e+"&verify_code="+t+"&invite_code="+o,timeout:1e4,cache:!1,beforeSend:function(e){},success:function(e,t){console.log(e),"undefined"!=typeof e.err&&(200==e.code?window.location.href=homeUrl+"create/index/"+e.data.step+"/"+e.data.token:r("#err-msg").html("<i>!</i>"+e.err))},complete:function(e,t){},error:function(){r("#err-msg").html("返回异常")}})}),r("#name").focus(function(){r("#err-yhm").html("")}),r("#realname").focus(function(){r("#err-xm").html("")}),r("#password").focus(function(){var e=r(this).val();/^.{8,16}$/.test(e)?r("#err-mm").html(""):r("#err-mm").html("<i>!</i>密码长度8~16位，数字、字母、字符至少包含两种")}).keyup(function(){r("#err-mm").html("")}),r("#com_password").focus(function(){r("#err-msg").html("")}),r("#next_step_userinfo").click(function(){r("#err-yhm").html(""),r("#err-xm").html(""),r("#err-mm").html(""),r("#err-msg").html("");var e=r("#token").val(),t=r("#name").val(),o=r("#realname").val(),n=r("#password").val(),c=r("#com_password").val();return i.isEmpty(t)?(r("#err-yhm").html("<i>!</i>请输入用户名！"),!1):i.isEmpty(o)?(r("#err-xm").html("<i>!</i>请输入真实姓名！"),!1):i.isEmpty(n)?(r("#err-mm").html("<i>!</i>请输入密码！"),!1):/^.{8,16}$/.test(n)?i.isEmpty(c)?(r("#err-msg").html("<i>!</i>请输入确认密码！"),!1):c!==n?(r("#err-msg").html("<i>!</i>两次输入的密码不一致哦！"),!1):void r.ajax({url:homeUrl+"create/exec_step_3",type:"post",dataType:"json",data:"token="+e+"&name="+t+"&realname="+o+"&password="+n+"&com_password="+c,timeout:1e4,cache:!1,beforeSend:function(e){},success:function(e,t){console.log(e),"undefined"!=typeof e.err&&(200==e.code?window.location.href=homeUrl+"create/index/3/"+e.data:a.showmsg(e.err,"",1e3))},complete:function(e,t){},error:function(){a.showmsg("数据返回有误，请稍后再试!","",1e3)}}):(r("#err-mm").html("<i>!</i>密码长度8~16位，数字、字母、字符至少包含两种"),!1)}),r("#province_id").on("change",function(){r("#err-province").html("");var e=r("#province_id").val(),t='<option value="0" selected="true">请选择城市</option>';r.ajax({type:"POST",url:homeUrl+"create/exec_change_province",data:{province_id:e},timeout:1e4,cache:!1,dataType:"json",success:function(e){if("undefined"!=typeof e.err)if(200==e.code){for(var o=e.data,n=0;n<o.length;n++)t+='<option value="'+o[n].id+'">'+o[n].name+"</option>";r("#city_id").html(t)}else r("#city_id").html(t);else r("#city_id").html(t)},error:function(){a.showmsg("数据返回有误，请稍后再试!","",1e3)}})}),r("#city_id").on("change",function(){r("#err-province").html("")}),r("#league_id").on("change",function(){r("#err-province").html("");var e=r("#league_id").val(),t='<option value="0" selected="true">请选择球队</option>';r.ajax({type:"POST",url:homeUrl+"create/exec_change_league",data:{league_id:e},timeout:1e4,chache:!1,dataType:"json",success:function(e){if("undefined"!=typeof e.err)if(200==e.code){for(var o=e.data,n=0;n<o.length;n++)t+='<option value="'+o[n].id+'">'+o[n].name+"</option>";r("#team_id").html(t)}else r("#team_id").html(t);else r("#team_id").html(t)},error:function(){a.showmsg("数据返回有误，请稍后再试!","",1e3)}})}),r("#team_id").on("change",function(){r("#err-msg").html("")}),r(document).on("change","#file",function(){r.ajaxfileupload({type:"post",url:homeUrl+"upload/fansclub_logo",dataType:"json",fileElementId:"file",success:function(e){200==e.code?e.data.width!==e.data.height?alert("亲，球迷会LOGO必须为正方形哦！"):(r("#fansclub_logo").val(e.data.logo),r(".btn-upload").html('<img style="position:absolute; left:0; top:0; width:115px; height:115px" src="'+homeUrl+"upload/"+e.data.logo+'" width="115" height="115">'),r("#err-file").html("")):alert(e.message)},error:function(e,t,o){alert(o)}})}),r("#fansclub-name").focus(function(e){r("#err-fansclub-name").html("")}),r("#next_step_fansclubinfo").click(function(){var e=r("#fansclub_logo").val(),t=r("#fansclub-name").val(),o=r("#province_id").val(),n=r("#city_id").val(),c=r("#league_id").val(),l=r("#team_id").val();return i.isEmpty(e)?(r("#err-file").html("<i>!</i>请上传球迷会logo"),!1):i.isEmpty(t)?(r("#err-fansclub-name").html("<i>!</i>请输入球迷会名称！"),!1):0==o||0==n?(r("#err-province").html("<i>!</i>请选择省份或城市！"),!1):0==c||0==l?(r("#err-msg").html("<i>!</i>请选择联赛或者球队哦！"),!1):void r.ajax({type:"post",url:homeUrl+"create/exec_step_4",data:r("#form-fansclub-create-3").serialize(),dataType:"json",cache:!1,success:function(e,t){"undefined"!=typeof e.err&&(200==e.code?window.location.href=homeUrl+"create/index/4/"+e.data:a.showmsg(e.err,"",1e3))},complete:function(e,t){},error:function(){a.showmsg("数据返回有误，请稍后再试!","",1e3)}})}),r("#next_login").click(function(){var e=r("#token").val();r.ajax({url:homeUrl+"create/exec_step_5",type:"post",dataType:"json",data:"token="+e,timeout:1e4,cache:!1,beforeSend:function(e){},success:function(e,t){console.log(e),200==e.code?window.location.href=homeUrl+"index":alert(e.message)},complete:function(e,t){},error:function(){alert("登录异常")}})})},c.set_remain_time=function(){0==l?(window.clearInterval(n),r("#btnSendCode").removeAttr("disabled"),r("#btnSendCode").val("重新发送"),l=60):(l--,r("#btnSendCode").val(l+"'"))},o.exports=c});