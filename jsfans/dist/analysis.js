define("test/analysis",["jquery","dateRange","common"],function(require,exports,module){"user strict";var $=require("jquery"),t=require("dateRange"),j=require("common"),a={};a.init=function(){var e=$("#analyTableCont"),n=$("#search_type").val();e.on({click:function(){var e=$(this),t=parseInt(e.prev(".page_num").find(".first").text())+1,r=parseInt(e.prev(".page_num").find(".last").text());a.ajaxsubmit(e,t,r,n,start_date,end_date,"next")}},"#page_nextbtn"),e.on({click:function(){var e=$(this),t=parseInt(e.next(".page_num").find(".first").text())-1,r=parseInt(e.next(".page_num").find(".last").text());a.ajaxsubmit(e,t,r,n,start_date,end_date,"prev")}},"#page_prevbtn"),e.on({click:function(){var e=$(this),t=(e.parent(".goto_area").prev().find("#page_prevbtn"),e.parent(".goto_area").prev().find("#page_nextbtn"),e.prev().val()),r=parseInt(t),s=/^\d+$/,i=parseInt($(this).parent(".goto_area").prev().find(".page_num .last").text());""==t||t>i||!s.test(t)?j.showmsg("请输入正确页码"):a.ajaxsubmit(e,r,i,n,start_date,end_date,"pagego")}},"#page_gobtn");new t.pickerDateRange("date_time",{aRecent7Days:"aRecent7DaysDemo3",isTodayValid:!0,startDate:start_date,endDate:end_date,needCompare:!0,defaultText:" 至 ",inputTrigger:"input_trigger_time",theme:"ta",success:function(e){start_date=e.startDate,end_date=e.endDate;var t=$("#analyTableCont #page_nextbtn"),r=parseInt(t.prev(".page_num").find(".first").text()),s=parseInt(t.prev(".page_num").find(".last").text());a.ajaxsubmit(t,r,s,n,start_date,end_date)}})},a.ajaxsubmit=function(_self,page,maxpage,search_type,startDate,endDate,type){$.ajax({type:"POST",url:homeUrl+"admin/member/exec_searchactive",data:{search_type:search_type,logmin:start_date,logmax:end_date,page:page},dataType:"json",success:function(data){var html="";if(200===data.code){for(var item=eval(data.data.list),i=0;i<data.data.list.length;i++)html+="<tr>",html+="<td>"+item[i].rank+"</td>",html+='<td><img src="'+item[i].avatar+'" alt="" class="user-head-45"><span>'+item[i].username+"</span></td>",html+="<td>"+item[i].realname+"</td>",html+="<td>"+item[i].join_count+"</td>",html+="<td>"+item[i].miss_count+"</td>",html+="</tr>";if($("#analyTableCont #table-body").html(html),"next"==type)_self.prev(".page_num").find(".first").text(page),_self.parent(".page_nav_area").find("#page_prevbtn").show(),maxpage==page&&_self.hide();else if("prev"==type)_self.next(".page_num").find(".first").text(page),_self.parent(".page_nav_area").find("#page_nextbtn").show(),1==page&&_self.hide();else if("pagego"==type){_self.parent(".goto_area").prev(".page_nav_area").find(".first").text(page);var prev=_self.parent(".goto_area").prev().find("#page_prevbtn"),next=_self.parent(".goto_area").prev().find("#page_nextbtn");maxpage==page?(prev.show(),next.hide()):1==page?(next.show(),prev.hide()):(prev.show(),next.show())}}else $("#analyTableCont #table-body").html("暂无数据")},error:function(){j.showmsg("数据有问题","",1e3)}})},module.exports=a});