var core={};core.confirm=function(t,a){var e='<div id="core_alert"><div class="layer"></div><div class="tips modal-content"><div class="title">';e+=t,e+='</div><div class="modal-footer"><div class="btn btn-default" data-action="cancel">取消</div><div class="btn btn-primary" data-action="ok">确定</div>',e+="</div></div></div>",$("#core_tip").length>0&&$("#core_tip").remove();var o=$(e);$(document.body).append(o),$(".layer",o).fadeIn(100),$(".tips",o).fadeIn(100),o.find(".btn").unbind("click").click(function(){var t=$(this).data("action");"ok"==t&&a&&a(),o.remove()})},$(function(){function t(){$.ajax({type:"GET",url:hostUrl+"monitor-api/taiPtnActiveFault/getTaiPtnActiveFaultList?page=1&rows=10",cache:!1,dataType:"json",success:function(t){var a={id:"example2_paginate",data:hostUrl+"monitor-api/taiPtnActiveFault/getTaiPtnActiveFaultList",maxshowpageitem:6,pagelistcount:10,callBack:function(t){console.log(t.list.length);for(var a="",e=0;e<t.list.length;e++){var o=t.list[e];a+='<tr class="breakmeName" data-alarmid="'+o.alarmID+'">',a+=0==o.handleResult||3==o.handleResult?'<td><a href="javascript:void(0)" class="btn btn-sm btn-twitter btnConfirm" data-alarmid="'+o.alarmID+'">确认</a></td>':2==o.handleResult||4==o.handleResult?'<td><a href="javascript:void(0)" class="btn btn-sm bg-green btnHandle" data-alarmid="'+o.alarmID+'">完成确认</a></td>':'<td><a href="javascript:void(0)" class="btn btn-sm bg-red btnClear" data-alarmid="'+o.alarmID+'">其他状态</a></td>',a+="<td>"+o.handleSuggestion+"</td>",a+="<td>"+o.meName+"</td>",a+="<td>"+o.switchStateName+"</td>",a+="<td>"+o.raiseTime+"</td>",a+="<td>"+o.confirmTime+"</td>",a+="</tr>"}$("#power_ajaxForm").html(a)}};page.init(t.total,1,a)},error:function(){alert("数据有问题")}}),console.log("1")}function a(t){var a,e;t?(a=hostUrl+"monitor-api/taiResNode/getTaiResNodeProtectedList?nodeName="+t,e="&page=1&rows=10"):(a=hostUrl+"monitor-api/taiResNode/getTaiResNodeProtectedList",e="?page=1&rows=10"),$.ajax({type:"GET",url:a+e,cache:!1,dataType:"json",success:function(t){var e={id:"example2_paginate",data:a,maxshowpageitem:6,pagelistcount:10,callBack:function(t){var a="";if(t.list.length<=0)return $("#power_ajaxForm").html('<tr><td colspan="6" class="divAlign">暂无数据</td></tr>'),!1;for(var e=0;e<t.list.length;e++){var o=t.list[e];a+='<tr ids="'+o.resID+'">',a+='<td><a href="javascript:void(0)" class="btn btn-sm btn-twitter" data-id="'+o.resID+'">修改</a><a href="javascript:void(0)" target="_blank" class="btn btn-sm btn-danger" data-id="'+o.resID+'">删除</a></td>',a+="<td>"+o.emsName+"</td>",a+="<td>"+o.nodeName+"</td>",a+="<td>"+o.emR3NodeName+"</td>",a+="<td>"+o.emR4NodeName+"</td>",a+="<td>"+o.locationName+"</td>",a+="</tr>"}$("#power_ajaxForm").html(a)}};page.init(t.total,1,e)},error:function(){alert("数据有问题")}})}function e(t,a,e,i,n){n?$("#updateId").val(n):$("#usernames").val(""),$.ajax({type:"GET",url:hostUrl+"monitor-api/taiResNode/getTaiResNodeAllList",cache:!1,dataType:"json",success:function(a){for(var n="",r=0;r<a.list.length;r++){var d=a.list[r];n+=d.nodeUuid==t?'<option value="'+d.nodeUuid+'" selected="true">'+d.nodeName+"</option>":'<option value="'+d.nodeUuid+'">'+d.nodeName+"</option>"}$("#nodeUuidBox").html(n);var l=$("#nodeUuidBox").val();e&&i?o(l,e,i):o(l)},error:function(){alert("数据有问题")}}),$.ajax({type:"GET",url:hostUrl+"monitor-api/taiResNode/getResLocationAllList?nodeUuid=",cache:!1,dataType:"json",success:function(t){for(var e="",o=0;o<t.list.length;o++){var i=t.list[o];e+=i.locationId==a?'<option value="'+i.locationId+'" selected="true">'+i.locationName+"</option>":'<option value="'+i.locationId+'">'+i.locationName+"</option>"}$("#locationIdBox").html(e)},error:function(){alert("数据有问题")}})}function o(t,a,e){$.ajax({type:"GET",url:hostUrl+"monitor-api/taiResNode/getTaiResNodeUUidList?nodeUuid="+t,cache:!1,dataType:"json",success:function(t){for(var o="",i="",n=0;n<t.list.length;n++){var r=t.list[n];o+=r.nodeUuid==a?'<option value="'+r.nodeUuid+'" selected="true">'+r.nodeName+"</option>":'<option value="'+r.nodeUuid+'">'+r.nodeName+"</option>",i+=r.nodeUuid==e?'<option value="'+r.nodeUuid+'" selected="true">'+r.nodeName+"</option>":'<option value="'+r.nodeUuid+'">'+r.nodeName+"</option>"}$("#emR3NodeIdLeft").html(o),$("#emR4NodeIdRight").html(i)},error:function(){alert("数据有问题")}})}function i(t){var a,e;t?(a=c+"?meName="+t,e="&page=1&rows=10"):(a=c,e="?page=1&rows=10"),$.ajax({type:"GET",url:a+e,cache:!1,dataType:"json",success:function(t){var e={id:"example2_paginate",data:a,maxshowpageitem:6,pagelistcount:10,callBack:function(t){var a="";if(t.error_code)return $("#power_ajaxForm").html('<tr><td colspan="7" class="divAlign">'+t.error_msg+"</td></tr>"),!1;for(var e=0;e<t.list.length;e++){var o=t.list[e];a+="<tr>",a+="<td>"+o.handleSuggestion+"</td>",a+="<td>"+o.aMeName+"</td>",a+="<td>"+o.meName+"</td>",a+="<td>"+o.switchState+"</td>",a+="<td>"+o.alarmState+"</td>",a+="<td>"+o.raiseTime+"</td>",a+="<td>"+o.confirmTime+"</td>",a+="</tr>"}$("#power_ajaxForm").html(a)}};page.init(t.total,1,e)},error:function(){alert("数据有问题")}})}function n(t){var a,e;t?(a=m+"?nodeName="+t,e="&page=1&rows=10"):(a=m,e="?page=1&rows=10"),$.ajax({type:"GET",url:a+e,cache:!1,dataType:"json",success:function(t){var e={id:"example2_paginate",data:a,maxshowpageitem:6,pagelistcount:10,callBack:function(t){var a="<thead><tr><th>网元名称</th><th>创建时间</th><th>位置</th><th>厂家</th></tr></thead><tbody>";if(t.list.length<=0)return a+='<tr><td colspan="4" class="divAlign">暂无数据</td></tr>',$("#power_ajaxForm").html(a),!1;for(var e=0;e<t.list.length;e++){var o=t.list[e];a+="<tr>",a+="<td>"+o.nodeName+"</td>",a+="<td>"+o.createTime+"</td>",a+="<td>"+o.locationName+"</td>",a+="<td>"+o.vendorName+"</td>",a+="</tr>"}a+="</tbody>",$("#power_ajaxForm").html(a)}};page.init(t.total,1,e)},error:function(){alert("数据有问题")}})}function r(){$.ajax({type:"GET",url:u+"?page=1&rows=10",cache:!1,dataType:"json",success:function(t){var a={id:"example2_paginate",data:u,maxshowpageitem:6,pagelistcount:10,callBack:function(t){for(var a='<thead><tr><th width="auto">网元端口连接关系</th><th width="150">创建时间</th><th width="67">位置</th><th width="90">厂家</th></tr></thead><tbody>',e=0;e<t.list.length;e++){var o=t.list[e];a+="<tr>",a+="<td>"+o.linkName+"</td>",a+="<td>"+o.createTime+"</td>",a+="<td>"+o.locationName+"</td>",a+="<td>"+o.vendorName+"</td>",a+="</tr>"}a+="</tbody>",$("#power_ajaxForm").html(a)}};page.init(t.total,1,a)},error:function(){alert("数据有问题")}})}function d(){$.ajax({type:"GET",url:v+"&page=1&rows=10",cache:!1,dataType:"json",success:function(t){var a={id:"example2_paginate",data:v,maxshowpageitem:6,pagelistcount:10,callBack:function(t){for(var a="<thead><tr><th>网元名称</th><th>告警类型</th><th>告警时间</th><th>告警清除时间</th><th>厂家/设备</th></tr></thead><tbody>",e=0;e<t.list.length;e++){var o=t.list[e];a+="<tr>",a+="<td>"+o.meName+"</td>",a+="<td>"+o.nativeProbableCause+"</td>",a+="<td>"+o.raiseTime+"</td>",a+="<td>"+o.clearTime+"</td>",a+="<td>"+o.vendorName+"</td>",a+="</tr>"}a+="</tbody>",$("#power_ajaxForm").html(a)}};page.init(t.total,1,a)},error:function(){alert("数据有问题")}})}function l(t){return""==$.trim(t)||void 0==t}if($(".subCompanyName").val(subCompanyName),$("#breakMonitor").length&&(t(),setInterval(t,time),$("#breakMonitor").on({click:function(){var t=$(this).data("alarmid");$.ajax({type:"GET",url:hostUrl+"monitor-api/taiPtnActiveFault/getTaiPtnActiveInfoList?alarmID="+t+"&page=1&rows=10",cache:!1,dataType:"json",success:function(t){for(var a="",e=0;e<t.list.length;e++){var o=t.list[e];a+="<tr>",a+="<td>"+o.meName+"</td>",a+="<td>"+o.nativeProbableCause+"</td>",a+="<td>"+o.raiseTime+"</td>",a+="<td>"+o.alarmSeverityText+"</td>",a+="</tr>"}$("#alarmStateBox").html(a)},error:function(){alert("数据有问题")}})}},".breakmeName"),$("#breakMonitor").on({click:function(){var t=($(this),$(this).data("alarmid"));core.confirm("是否确认修改",function(){$.ajax({type:"POST",url:hostUrl+"monitor-api/taiPtnActiveFault/confirmTaiPtnActiveFault?alarmID="+t,cache:!1,dataType:"json",success:function(t){0==t.code?window.location.reload():alert(t.message)},error:function(){alert("数据有问题")}})})}},".btnConfirm"),$("#breakMonitor").on({click:function(){var t=($(this),$(this).data("alarmid"));core.confirm("是否告警信息确认完成",function(){$.ajax({type:"POST",url:hostUrl+"monitor-api/taiPtnActiveFault/handleTaiPtnActiveFault?alarmID="+t,cache:!1,dataType:"json",success:function(t){0==t.code?window.location.reload():alert(t.message)},error:function(){alert("数据有问题")}})})}},".btnHandle")),$("#elementConfig").length){document.title="网元配置",a(),$("#nodeUuidBox").on("change",function(){var t=$(this).val();o(t)}),$("#myModal").on("show.bs.modal",function(){e()});var s=!1;$("#myModal .btn-primary").on("click",function(){var t=$("#usernames").val(),a=$("#nodeUuidBox").val(),e=$('#nodeUuidBox option[value="'+a+'"]').text(),o=$("#emR3NodeIdLeft").val(),i=$('#emR3NodeIdLeft option[value="'+o+'"]').text(),n=$("#emR4NodeIdRight").val(),r=$('#emR4NodeIdRight option[value="'+n+'"]').text(),d=$("#locationIdBox").val(),c=$('#locationIdBox option[value="'+d+'"]').text(),m=$("#updateId").val(),u={nodeUuid:a,emName:t,emR3NodeId:o,emR4NodeId:n,locationId:d},v={emId:m,nodeUuid:a,emName:t,emR3NodeId:o,emR4NodeId:n,locationId:d};return l(t)?(alert("请填写设备名称再确认哦！"),!1):void(s?$.ajax({type:"POST",url:hostUrl+"monitor-api/taiPtnEmdev/updateTaiPtnEmdev",data:{params:JSON.stringify(v)},cache:!1,dataType:"json",success:function(a){if(0==a.code){var o="";o+='<td><a href="javascript:void(0)" target="_blank" class="btn btn-sm btn-twitter" data-id="'+m+'">修改</a><a href="javascript:void(0)" target="_blank" class="btn btn-sm btn-danger" data-id="'+m+'">删除</a></td>',o+="<td>"+t+"</td>",o+="<td>"+e+"</td>",o+="<td>"+i+"</td>",o+="<td>"+r+"</td>",o+="<td>"+c+"</td>",$('#power_ajaxForm tr[ids="'+m+'"]').html(o),$("#myModal").modal("hide"),s=!1}else alert(a.message)},error:function(){alert("数据请求有问题")}}):$.ajax({type:"POST",url:hostUrl+"monitor-api/taiPtnEmdev/saveTaiPtnEmdev",data:{params:JSON.stringify(u)},cache:!1,dataType:"json",success:function(a){if(0==a.code){var o='<tr ids="'+a.emId+'">';o+='<td><a href="javascript:void(0)" target="_blank" class="btn btn-sm btn-twitter" data-id="'+a.emId+'">修改</a><a href="javascript:void(0)" target="_blank" class="btn btn-sm btn-danger" data-id="'+a.emId+'">删除</a></td>',o+="<td>"+t+"</td>",o+="<td>"+e+"</td>",o+="<td>"+i+"</td>",o+="<td>"+r+"</td>",o+="<td>"+c+"</td>",o+="</tr>",$("#power_ajaxForm").prepend(o),$("#myModal").modal("hide")}else alert(a.message)},error:function(){alert("数据有问题")}}))}),$("#elementConfig").on({click:function(){$("#myModal").modal("toggle"),s=!0;var t=$(this).data("id");$.ajax({type:"GET",url:hostUrl+"monitor-api/taiPtnEmdev/getTaiPtnEmdev?emId="+t,cache:!1,dataType:"json",success:function(a){$("#usernames").val(a.taiPtnEmdev.emName),e(a.taiPtnEmdev.nodeUuid,a.taiPtnEmdev.locationId,a.taiPtnEmdev.emR3NodeId,a.taiPtnEmdev.emR4NodeId,t)},error:function(){alert("数据有问题")}})}},".btn-twitter"),$("#elementConfig").on({click:function(){var t=$(this).data("id"),a=$(this);return core.confirm("是否确认删除此信息！删除后将无法恢复",function(){$.ajax({type:"DELETE",url:hostUrl+"monitor-api/taiPtnEmdev/deleteTaiPtnEmdev?emId="+t,contentType:"application/json; charset=utf-8",cache:!1,dataType:"json",success:function(t){0==t.code?a.closest("tr").remove():alert(t.message)},error:function(){alert("数据返回有问题")}})}),!1}},".btn-danger"),$("#btn_elementConfiy").click(function(){var t=$("#usertextid").val();return a(t),!1})}if($("#alarmLog").length){document.title="告警日志";var c=hostUrl+"monitor-api/taiPtnActiveFault/getTaiPtnHisFaultInfoList";i(),$("#btn_elementConfiy").click(function(){var t=$("#usertextid").val();return i(t),!1})}if($("#elementInfo").length){document.title="网元信息";var m=hostUrl+"monitor-api/taiResNode/getTaiResNodeList",u=hostUrl+"monitor-api/taiResNode/getTaiResLinkList",v=hostUrl+"monitor-api/taiPtnActiveFault/getTaiPtnActiveInfoList?alarmID=be6ad0d9-5de8-4fd3-b971-571767f964f0";n(),$(".box_left_ch .btn").click(function(){$(".box_left_ch .btn").removeClass("btn-success"),$(this).addClass("btn-success");var t=$(this).data("id");"getTaiResNodeList"==t?n():"getTaiResLinkList"==t?r():"getTaiPtnActiveInfoList"==t&&d()}),$("#btn_elementConfiy").click(function(){var t=$("#usertextid").val();return n(t),!1})}var p=/(breakMonitor|elementConfig|elementInfo|alarmLog)/.exec(location.href),h={breakMonitor:1,elementConfig:2,elementInfo:3,alarmLog:4};null==p||""==p?$(".sidebar-menu li").eq(0).addClass("active"):($(".sidebar-menu li").removeClass("active"),$(".sidebar-menu li").eq(h[p[0]]).addClass("active")),$("#email").focus(function(){$("#tit_tip").html("")}),$("#password").focus(function(){$("#tit_tip").html("")}),$("#login_btnSubmit").click(function(){return l($("#email").val())?($("#tit_tip").html("账号不能为空哦！"),!1):l($("#password").val())?($("#tit_tip").html("密码不能为空哦！"),!1):void $.ajax({type:"POST",url:hostUrl+"monitor-api/login/m_v1/userLogin",data:{userName:$("#email").val(),password:$("#password").val()},dataType:"json",cache:!1,success:function(t){"00"==t.code?window.location.href="/monitor-web/menu/m_v1/breakMonitor.html":$("#tit_tip").html(t.message)},error:function(){alert("数据有问题")}})})});