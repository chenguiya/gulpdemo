define("test/defined_field_set",["common","layer","js/module/layer/skin/layer.css"],function(e,i,t){"user strict";var n=e("common");e("layer");e("js/module/layer/skin/layer.css");var a=($("#fid").val(),$("#formtype").val()),d=/^\d+$/;$("#btn_cancels").click(function(){var e=parent.layer.getFrameIndex(window.name);parent.layer.close(e)});var s,l=!1;$("#title").focus(function(){var e=$(this);e.next().removeClass("Tipshow")}).blur(function(){var e=$(this),i=e.val(),t=i.length;if("text"==a){if(t>10||""==i)return e.next().html("最多不能超过10个字符"),e.next().addClass("Tipshow"),l=!1,!1;l=!0,e.next().html(""),e.next().removeClass("Tipshow")}else{if(t>20)return e.next().html("最多不能超过20个字符"),e.next().addClass("Tipshow"),l=!1,!1;l=!0,e.next().html(""),e.next().removeClass("Tipshow")}}),$("#btn_ok").click(function(){var e=$("#fid").val(),i=$("#formtype").val(),t=$("#title").val(),a=parseInt($("#minlength").val()),o=parseInt($("#minlength").attr("min")),r=parseInt($("#maxlength").val()),c=parseInt($("#maxlength").attr("max")),p=$(this).data("field");if($(".recruit_radioico").each(function(){var e=$(this);e.find("input").is(":checked")&&(s=e.find("input").val())}),""==a||o>a)a=1;else{if(!d.test(a))return n.showmsg("亲，内容选项中要输入数字哦！","",1e3),!1;if(a>r||a>c)return n.showmsg("亲，最少项不能超过最大项哦","",1e3),!1}if(""==r||o>=r)r=c;else{if(!d.test(r))return n.showmsg("亲，内容选项中要输入数字哦！","",1e3),!1;if(r>c)return n.showmsg("亲，最大项不能超过默认"+c+"个字符哦","",1e3),!1}if(""!==p)$.ajax({type:"POST",url:homeUrl+"admin/defined_field/edit",data:{fieldid:p,fid:e,formtype:i,title:t,minlength:a,maxlength:r,invisible:s,do_submit:"do_submit"},cache:!1,dataType:"json",success:function(e){f.defindeedit(e)},error:function(){n.showmsg("数据返回异常","",1e3)}});else{if(!l)return n.showmsg("请完善数据再确定哦","",1e3),!1;$.ajax({type:"POST",url:homeUrl+"admin/defined_field/add",data:{fid:e,formtype:i,title:t,minlength:a,maxlength:r,invisible:s,do_submit:"do_submit"},cache:!1,dataType:"json",success:function(e){f.defindeok(e)},error:function(){n.showmsg("数据返回异常","",1e3)}})}}),$("#click_addpoll").click(function(){var e=$(".opitionItem p").length,i='<p><input type="text" class="input-text" name="package_'+e+'" placeholder="最多不能超过20个字符" value="" /><span class="pack_colse"></span><span class="Tipover"></span></p>';$(".opitionItem").append(i),e++,e>9&&$(this).parent().css("display","none")});var o=$(".opitionItem");o.on({click:function(){var e=$(this);e.parent().remove();var i=$(".opitionItem").find("p").length;10>i&&$("#click_addpoll").parent().css("display","block")}},".pack_colse");var r=!1;o.find("input").focus(function(){var e=$(this);e.next().removeClass("Tipshow")}).blur(function(){var e=$(this),i=e.val(),t=i.length;return t>20||""==i?(e.next(".Tipover").html("最多不能超过20个字符"),e.next(".Tipover").addClass("Tipshow"),r=!1,!1):(r=!0,e.next(".Tipover").html(""),e.next(".Tipover").removeClass("Tipshow"),void 0)}),$("#btn_radiook").click(function(){var e=$(this).data("field"),i=new Array,t=!0,a=$("#fid").val(),d=$("#formtype").val(),c=$("#title").val();o.find("p").each(function(e){i[e]=$(this).find("input").val(),""==i[e]&&(o.find("p").eq(e).children(".Tipover").html("最多不能超过20个字符"),o.find("p").eq(e).children(".Tipover").addClass("Tipshow"),t=!1)}),$(".recruit_radioico").each(function(){var e=$(this);e.find("input").is(":checked")&&(s=e.find("input").val())});i.join();""!==e?t&&$.ajax({type:"POST",url:homeUrl+"admin/defined_field/edit",data:{fieldid:e,fid:a,formtype:d,title:c,option:i,invisible:s,do_submit:"do_submit"},cache:!1,dataType:"json",success:function(e){f.defindeedit(e)},error:function(){n.showmsg("数据返回异常","",1e3)}}):l&&r?t&&$.ajax({type:"POST",url:homeUrl+"admin/defined_field/add",data:{fid:a,formtype:d,title:c,option:i,invisible:s,do_submit:"do_submit"},cache:!1,dataType:"json",success:function(e){f.defindeok(e)},error:function(){n.showmsg("数据返回异常","",1e3)}}):n.showmsg("请完善数据再确定哦","",1e3)}),$("#btn_selectok").click(function(){var e=$(this).data("field"),i=new Array,t=!0,a=$("#fid").val(),c=$("#formtype").val(),p=$("#title").val(),m=parseInt($("#minlength").val()),h=parseInt($("#minlength").attr("min")),u=parseInt($("#maxlength").val()),v=parseInt($("#maxlength").attr("max"));o.find("p").each(function(e){i[e]=$(this).find("input").val(),""==i[e]&&(o.find("p").eq(e).children(".Tipover").html("最多不能超过20个字符"),o.find("p").eq(e).children(".Tipover").addClass("Tipshow"),t=!1)}),$(".recruit_radioico").each(function(){var e=$(this);e.find("input").is(":checked")&&(s=e.find("input").val())});var g=o.find("p").length;if(""==m||h>m)m=1;else{if(!d.test(m))return n.showmsg("亲，内容选项中要输入数字哦！","",1e3),!1;if(m>u||m>v||m>g)return n.showmsg("亲，最少选项不能超过最多选项项哦","",1e3),!1}if(""==u||h>=u)u=v;else{if(!d.test(u))return n.showmsg("亲，内容选项中要输入数字哦！","",1e3),!1;if(u>g)return n.showmsg("亲，最多选项不能超过"+g+"项","",1e3),!1}i.join();""!==e?t&&$.ajax({type:"POST",url:homeUrl+"admin/defined_field/edit",data:{fieldid:e,fid:a,formtype:c,title:p,option:i,minlength:m,maxlength:u,invisible:s,do_submit:"do_submit"},cache:!1,dataType:"json",success:function(e){f.defindeedit(e)},error:function(){n.showmsg("数据返回异常","",1e3)}}):l&&r?t&&$.ajax({type:"POST",url:homeUrl+"admin/defined_field/add",data:{fid:a,formtype:c,title:p,option:i,minlength:m,maxlength:u,invisible:s,do_submit:"do_submit"},cache:!1,dataType:"json",success:function(e){f.defindeok(e)},error:function(){n.showmsg("数据返回异常","",1e3)}}):n.showmsg("请完善数据再确定哦","",1e3)});var f={};f.defindeok=function(e){if(200==e.code){var i='<div class="edit_input" data-field="'+e.data.fieldid+'"><span class="edit_type"><em>'+e.data.title+'</em><i class="close_defined"></i></span><a href="javascript:void(0)" class="edit_define" data-click="编辑设置,/admin/defined_field/edit?fieldid='+e.data.fieldid+',570,570">编辑>></a></div>';parent.$("#editAdd_each").append(i);var t=parent.$("#editAdd_type").find(".edit_input").length;t>4&&parent.$("#defined_btn").css("display","none");var a=new Array;parent.$("#editAdd_each").find(".edit_input").each(function(e){a[e]=$(this).data("field")}),parent.$("#fieldids").val(a);var d=parent.layer.getFrameIndex(window.name);parent.layer.close(d)}else n.showmsg(e.message,"",1e3)},f.defindeedit=function(e){if(200==e.code){parent.$("#editAdd_type").find('.edit_input[data-field="'+e.data.fieldid+'"] .edit_type').html("<em>"+e.data.title+'</em><i class="close_defined"></i>');var i=parent.layer.getFrameIndex(window.name);parent.layer.close(i)}else n.showmsg(e.message,"",1e3)},f.CheckLength=function(e){var i,t;for(t=0,i=0;i<e.length;i++)t+=e.charCodeAt(i)>0&&e.charCodeAt(i)<=255?1:2;return t}});