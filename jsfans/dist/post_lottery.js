define("test/post_lottery",["jquery","common","layer","js/module/layer/skin/layer.css"],function(require,exports,module){"user strict";var $=require("jquery"),layer=require("layer"),j=require("common");require("js/module/layer/skin/layer.css");var m={};m.init=function(){var uploadm=$("#selectUPload");uploadm.on({click:function(){var uphtm="";$.ajax({type:"GET",url:homeUrl+"admin/lottery/template?isajax=1",dataType:"json",success:function(data){var tem=eval(data.data);uphtm+='<ul class="lotterDiv">';for(var w=0;w<data.data.length;w++)uphtm+='<li id="'+tem[w].id+'"><img src="'+tem[w].image+'" width="270" height="155"></li>';uphtm+="</ul>",m.commonHtml(uphtm,"选择模板","720","500","submitupload")},error:function(){j.showmsg("数据偶问题","",1e3)}})}},".uploadBtn_ch");var namelist=$("#activityCenter");namelist.on({click:function(){var html="";$.ajax({type:"GET",url:homeUrl+"admin/activity/lists?isajax=1",dataType:"json",success:function(data){var item=eval(data.data);html+='<ul class="activiUl">';for(var i=0;i<data.data.length;i++)html+='<li><input type="radio" name="activityname" value="" id="'+item[i].tid+'"> <label for="activtiy_'+item[i].tid+'">'+item[i].title+"</label></li>";html+="</ul>",m.commonHtml(html,"活动列表","560","","subminttrue")},error:function(){j.showmsg("数据有问题","",1e3)}})}},".lottery_Jia"),namelist.on({click:function(){$(this).parent(".lotteryJbox").hide(),$(this).parent(".lotteryJbox").siblings(".lottery_Jia").show()}},".coverDetele"),$("#click_addlottery").length&&$("#click_addlottery").click(function(){var t=$(".lotteryNumItem .itemLot").length,e='<div class="itemLot cl" id="prize_'+t+'">';e+='<p class="av40">'+(t+1)+"等奖：",e+='<input type="hidden" name="prize['+t+'][level]" value="'+(t+1)+'" />',e+='<input type="text" class="input-text" name="prize['+t+'][num]" placeholder="" value="" /> 人',e+="</p>",e+="</div>",$(this).parent().siblings(".lotteryNumItem").append(e),t++})},m.commonHtml=function(t,e,i,a,l){var n=$("#append_parent");"undefined"==typeof i&&(i=400),"undefined"==typeof a&&(a=400);var r='<div id="overpop"><style>html{overflow:hidden}</style><div id="maskover" style="display:block"></div>';r+='<div class="layer_shadeCon" style="width:'+i+"px; height:"+a+"px; margin-left:-"+i/2+'px;">',r+='<div class="maskhd">'+e+'<a href="javascript:;" class="icon-close"></a></div>',r+='<div class="layerContent">'+t+"</div>",r+='<div class="layer_submit"><a href="javascript:;" class="'+l+'">确定</a></div>',r+="</div></div>",n.append(r),n.find(".icon-close").length>0&&n.find(".icon-close").click(function(){$(this).parents("#overpop").remove()});var o,s="";n.find(".activiUl li input").click(function(){$(this).is(":checked")&&(s=$(this).attr("id"),o=$(this).siblings("label").text())}),n.find(".subminttrue").click(function(){var t=$(this).parents("#overpop").find(".layerContent li input");t.is(":checked")?($("#activityCenter input#lottaid").val(s),$("#activityCenter span.input-text").attr("id",s),$("#activityCenter span.input-text").text(o),$("#activityCenter .lotteryJbox").show(),$("#activityCenter .lottery_Jia").hide(),$(this).parents("#overpop").remove()):j.showmsg("请选择活动名称","",1e3)});var c,d;n.find(".lotterDiv li").click(function(){n.find(".lotterDiv li").removeClass("hover"),$(this).addClass("hover"),c=$(this).attr("id"),d=$(this).find("img").attr("src")}),n.find(".submitupload").click(function(){if("undefined"!=typeof c){var t='<div class="coverPop" id="coverDetle"><img src="'+d+'"><a href="javascript:void(0)" class="coverDetele icon-cw" id="coverDetele" onclick="shell.hideK()"></a></div>';$("#templateid").val(c),$(this).parents("#overpop").remove(),$("#selectUPload .btn_upload").hide(),$("#selectUPload #previewid").append(t)}else j.showmsg("请选择模板","",1e3)})},m.layer_show=function(t,e,i,a){(null==t||""==t)&&(t=!1),(null==e||""==e)&&(e="404.html"),(null==i||""==i)&&(i=800),(null==a||""==a)&&(a=$(window).height()-50),layer.open({type:2,area:[i+"px",a+"px"],fix:!1,maxmin:!0,scrollbar:!1,shade:.4,title:t,content:e})},module.exports=m});