var core={};core.confirm=function(t,a){var e='<div id="core_alert"><div class="layer"></div><div class="tips modal-content"><div class="title">';e+=t,e+='</div><div class="modal-footer"><div class="btn btn-default" data-action="cancel">取消</div><div class="btn btn-primary" data-action="ok">确定</div>',e+="</div></div></div>",$("#core_tip").length>0&&$("#core_tip").remove();var i=$(e);$(document.body).append(i),$(".layer",i).fadeIn(100),$(".tips",i).fadeIn(100),i.find(".btn").unbind("click").click(function(){var t=$(this).data("action");"ok"==t&&a&&a(),i.remove()})},$(function(){function t(t){return""==$.trim(t)||void 0==t}function a(){$.ajax({type:"GET",url:l+"?page=1&rows=10",cache:!1,dataType:"json",success:function(t){var a={id:"example2_paginate",data:l,maxshowpageitem:6,pagelistcount:10,callBack:function(t){for(var a='<thead><tr><th width="150">维护建议</th><th width="auto">监控网元</th><th width="187">设备状态</th><th width="197">告警时间</th><th width="120">告警确认时间</th><th width="100">维护确认</th></tr></thead><tbody>',e=0;e<t.list.length;e++){var i=t.list[e];a+="<tr>",a+="<td>"+i.handleSuggestion+"</td>",a+="<td>"+i.meName+"</td>",a+="<td>"+i.switchStateName+"</td>",a+="<td>"+i.raiseTime+"</td>",a+="<td>"+i.confirmTime+"</td>",a+=0==i.handleResult||3==i.handleResult?'<td><a href="javascript:void(0)" class="btn btn-sm btn-success btnConfirm" data-alarmid="'+i.alarmID+'">确认</a></td>':2==i.handleResult||4==i.handleResult?'<td><a href="javascript:void(0)" class="btn btn-sm btn-info btnHandle" data-alarmid="'+i.alarmID+'">完成确认</a></td>':'<td><a href="javascript:void(0)" class="btn btn-sm btn-success" data-alarmid="'+i.alarmID+'">其他状态出现</a></td>',a+="</tr>"}a+="</tbody>",$("#example_ajaxForm").html(a)}};page.init(t.total,1,a)},error:function(){alert("数据有问题")}})}function e(t){var a,e;t?(a=l+"&meName="+t,e="&page=1&rows=10"):(a=l,e="&page=1&rows=10"),$.ajax({type:"GET",url:a+e,cache:!1,dataType:"json",success:function(t){var e={id:"example2_paginate",data:a,maxshowpageitem:6,pagelistcount:10,callBack:function(t){var a='<thead><tr><th width="auto">网元名称</th><th width="113">设备类型</th><th width="187">告警类型</th><th width="226">告警时间</th><th width="226">告警清除时间</th><th width="114">告警级别</th></tr></thead><tbody>';if(1==t.error_code)return a+='<tr><td colspan="6" class="divAlign">'+t.error_msg+"</td></tr>",$("#example_ajaxForm").html(a),!1;for(var e=0;e<t.list.length;e++){var i=t.list[e];a+="<tr>",a+="<td>"+i.meName+"</td>",a+="<td>"+i.vendorName+"</td>",a+="<td>"+i.nativeProbableCause+"</td>",a+="<td>"+i.raiseTime+"</td>",a+="<td>"+i.clearTime+"</td>",a+="<td>"+i.alarmSeverityText+"</td>",a+="</tr>"}a+="</tbody>",$("#example_ajaxForm").html(a)}};page.init(t.total,1,e)},error:function(){alert("数据有问题")}})}function i(t){var a,e;t?(a=l+"?nodeName="+t,e="&page=1&rows=10"):(a=l,e="?page=1&rows=10"),$.ajax({type:"GET",url:a+e,cache:!1,dataType:"json",success:function(t){var e={id:"example2_paginate",data:a,maxshowpageitem:6,pagelistcount:10,callBack:function(t){var a='<thead><tr><th width="auto">网元名称</th><th width="140">网元节点状态</th><th width="205">创建时间</th><th width="205">最后修改时间</th><th width="78">位置</th><th width="100">厂家</th></tr></thead><tbody>';if(t.list.length<=0)return a+='<tr><td colspan="6" class="divAlign">暂无数据记录</td></tr>',$("#example_ajaxForm").html(a),!1;for(var e=0;e<t.list.length;e++){var i=t.list[e];a+="<tr>",a+="<td>"+i.nodeName+"</td>",a+="<td>"+i.nodeStateName+"</td>",a+="<td>"+i.createTime+"</td>",a+="<td>"+i.lastModifyTime+"</td>",a+="<td>"+i.locationName+"</td>",a+="<td>"+i.vendorName+"</td>",a+="</tr>"}a+="</tbody>",$("#example_ajaxForm").html(a)}};page.init(t.total,1,e)},error:function(){alert("数据有问题")}})}function o(t){var a,e;t?(a=l+"?nodeName="+t,e="&page=1&rows=10"):(a=l,e="?page=1&rows=10"),$.ajax({type:"GET",url:a+e,cache:!1,dataType:"json",success:function(t){var e={id:"example2_paginate",data:a,maxshowpageitem:6,pagelistcount:10,callBack:function(t){var a='<thead><tr><th width="auto">网元端口连接关系</th><th width="200">创建时间</th><th width="90">空间</th><th width="90">厂家</th></tr></thead><tbody>';if(t.list.length<=0)return a+='<tr><td colspan="4" class="divAlign">暂无数据记录</td></tr>',$("#example_ajaxForm").html(a),!1;for(var e=0;e<t.list.length;e++){var i=t.list[e];a+="<tr>",a+="<td>"+i.linkName+"</td>",a+="<td>"+i.createTime+"</td>",a+="<td>"+i.locationName+"</td>",a+="<td>"+i.vendorName+"</td>",a+="</tr>"}a+="</tbody>",$("#example_ajaxForm").html(a)}};page.init(t.total,1,e)},error:function(){alert("数据有问题")}})}function n(t){var a,e;t?(a=l+"?nodeName="+t,e="&page=1&rows=10"):(a=l,e="?page=1&rows=10"),$.ajax({type:"GET",url:a+e,cache:!1,dataType:"json",success:function(t){var e={id:"example2_paginate",data:a,maxshowpageitem:6,pagelistcount:10,callBack:function(t){var a="";if(t.list.length<=0)return a+='<tr><td colspan="7" class="divAlign">暂无数据记录</td></tr>',$("#example_ajaxForm").html(a),!1;for(var e=0;e<t.list.length;e++){var i=t.list[e];a+='<tr ids="'+i.resID+'">',a+="<td>"+i.emsName+"</td>",a+="<td>"+i.nodeName+"</td>",a+="<td>"+i.emR3NodeName+"</td>",a+="<td>"+i.emR4NodeName+"</td>",a+="<td>"+i.locationName+"</td>",a+="<td>"+i.memo+"</td>",a+='<td><a href="javascript:void(0)" class="btn btn-sm btn-success" data-id="'+i.resID+'">修改</a><a href="javascript:void(0)" class="btn btn-sm btn-danger" data-id="'+i.resID+'">删除</a></td>',a+="</tr>"}$("#example_ajaxForm").html(a)}};page.init(t.total,1,e)},error:function(){alert("数据有问题")}})}function d(t,a,e,i,o){o?$("#updateId").val(o):($("#emsName_id").val(""),$("#memo_id").val("")),$.ajax({type:"GET",url:hostUrl+"monitor-api/taiResNode/getTaiResNodeAllList",cache:!1,dataType:"json",success:function(i){for(var o="",n=0;n<i.list.length;n++){var d=i.list[n];o+=d.nodeUuid==t?'<option value="'+d.nodeUuid+'" selected="true">'+d.nodeName+"</option>":'<option value="'+d.nodeUuid+'">'+d.nodeName+"</option>"}$("#nodeUuid_id").html(o);var l=$("#nodeUuid_id").val();a&&e?r(l,a,e):r(l)},error:function(){alert("数据有问题")}}),$.ajax({type:"GET",url:hostUrl+"monitor-api/taiResNode/getResLocationAllList",cache:!1,dataType:"json",success:function(t){for(var a="",e=0;e<t.list.length;e++){var o=t.list[e];a+=o.locationId==i?'<option value="'+o.locationId+'" selected="true">'+o.locationName+"</option>":'<option value="'+o.locationId+'">'+o.locationName+"</option>"}$("#locationName_id").html(a)},error:function(){alert("数据有问题")}})}function r(t,a,e){$.ajax({type:"GET",url:hostUrl+"monitor-api/taiResNode/getTaiResNodeUUidList?nodeUuid="+t,cache:!1,dataType:"json",success:function(t){for(var i="",o="",n=0;n<t.list.length;n++){var d=t.list[n];i+=d.nodeUuid==a?'<option value="'+d.nodeUuid+'" selected="true">'+d.nodeName+"</option>":'<option value="'+d.nodeUuid+'">'+d.nodeName+"</option>",o+=d.nodeUuid==e?'<option value="'+d.nodeUuid+'" selected="true">'+d.nodeName+"</option>":'<option value="'+d.nodeUuid+'">'+d.nodeName+"</option>"}$("#emR3NodeName_id").html(i),$("#emR4NodeName_id").html(o)},error:function(){alert("数据有问题")}})}if($(".subCompanyName").val(subCompanyName),$("#alarmSuggestion").length){var l=hostUrl+"monitor-api/taiPtnActiveFault/getTaiPtnActiveFaultList";a(),setInterval(a,time),$("#alarmSuggestion").on({click:function(){var t=($(this),$(this).data("alarmid"));core.confirm("告警维护是否确认？",function(){$.ajax({type:"POST",url:hostUrl+"monitor-api/taiPtnActiveFault/confirmTaiPtnActiveFault",data:{alarmID:t},cache:!1,dataType:"json",success:function(t){0==t.code?window.location.reload():alert(t.message)},error:function(){alert("数据有问题")}})})}},".btnConfirm"),$("#alarmSuggestion").on({click:function(){var t=($(this),$(this).data("alarmid"));core.confirm("告警维护是否确认完成?",function(){$.ajax({type:"POST",url:hostUrl+"monitor-api/taiPtnActiveFault/handleTaiPtnActiveFault",data:{alarmID:t},cache:!1,success:function(t){0==t.code?window.location.reload():alert(t.message)},error:function(){alert("数据有问题")}})})}},".btnHandle")}if($("#activeAlarm").length){document.title="活动告警";var l=hostUrl+"monitor-api/taiPtnActiveFault/getTaiPtnActiveInfoList?alarmID=be6ad0d9-5de8-4fd3-b971-571767f964f0";e(),$("#queryConfirm").click(function(){var t=$("#alarmText").val();return e(t),!1})}if($("#netElementList").length){document.title="网元列表";var l=hostUrl+"monitor-api/taiResNode/getTaiResNodeList";i(),$("#queryConfirm").click(function(){var t=$("#alarmText").val();return i(t),!1})}if($("#netElementPort").length){document.title="网元端口关系";var l=hostUrl+"monitor-api/taiResNode/getTaiResLinkList";o(),$("#queryConfirm").click(function(){var t=$("#alarmText").val();return o(t),!1})}if($("#netElementConfig").length){document.title="监控网元配置";var l=hostUrl+"monitor-api/taiResNode/getTaiResNodeProtectedList";n(),$("#nodeUuid_id").on("change",function(){var t=$(this).val();r(t)}),$("#queryConfirm").click(function(){var t=$("#alarmText").val();return n(t),!1}),$("#myModal").on("show.bs.modal",function(){d()});var s=!1;$("#myModal .btn-primary").on("click",function(){var a=$("#emsName_id").val(),e=$("#nodeUuid_id").val(),i=$('#nodeUuid_id option[value="'+e+'"]').text(),o=$("#emR3NodeName_id").val(),n=$('#emR3NodeName_id option[value="'+o+'"]').text(),d=$("#emR4NodeName_id").val(),r=$('#emR4NodeName_id option[value="'+d+'"]').text(),l=$("#locationName_id").val(),c=$('#locationName_id option[value="'+l+'"]').text(),m=$("#memo_id").val(),h=$("#updateId").val(),u={nodeUuid:e,emName:a,emR3NodeId:o,emR4NodeId:d,locationId:l,memo:m},v={emId:h,nodeUuid:e,emName:a,emR3NodeId:o,emR4NodeId:d,locationId:l,memo:m};return t(a)?(alert("请填写断电装置名称再提交哦!"),!1):void(s?$.ajax({type:"POST",url:hostUrl+"monitor-api/taiPtnEmdev/saveTaiPtnEmdev",data:{params:JSON.stringify(v)},cache:!1,dataType:"json",success:function(t){if(0==t.code){var e="<td>"+a+"</td>";e+="<td>"+i+"</td>",e+="<td>"+n+"</td>",e+="<td>"+r+"</td>",e+="<td>"+c+"</td>",e+="<td>"+m+"</td>",e+='<td><a href="javascript:void(0)" class="btn btn-sm btn-success" data-id="'+h+'">修改</a><a href="javascript:void(0)" class="btn btn-sm btn-danger" data-id="'+h+'">删除</a></td>',$('#example_ajaxForm tr[ids="'+h+'"]').html(e),$("#myModal").modal("hide"),s=!1}else alert(t.message)},error:function(){alert("数据返回有问题")}}):$.ajax({type:"POST",url:hostUrl+"monitor-api/taiPtnEmdev/saveTaiPtnEmdev",data:{params:JSON.stringify(u)},cache:!1,dataType:"json",success:function(t){if(0==t.code){var e='<tr ids="'+t.emId+'">';e+="<td>"+a+"</td>",e+="<td>"+i+"</td>",e+="<td>"+n+"</td>",e+="<td>"+r+"</td>",e+="<td>"+c+"</td>",e+="<td>"+m+"</td>",e+='<td><a href="javascript:void(0)" class="btn btn-sm btn-success" data-id="'+t.emId+'">修改</a><a href="javascript:void(0)" class="btn btn-sm btn-danger" data-id="'+t.emId+'">删除</a></td>',e+="</tr>",$("#example_ajaxForm").prepend(e),$("#example_ajaxForm").find(".divAlign").length&&$("#example_ajaxForm").find(".divAlign").closest("tr").remove(),$("#myModal").modal("hide")}else alert(t.message)},error:function(){alert("数据有问题")}}))}),$("#netElementConfig").on({click:function(){$("#myModal").modal("toggle"),s=!0;var t=$(this).data("id");$.ajax({type:"GET",url:hostUrl+"monitor-api/taiPtnEmdev/getTaiPtnEmdev?emId="+t,cache:!1,dataType:"json",success:function(a){$("#emsName_id").val(a.taiPtnEmdev.emName),$("#memo_id").val(a.taiPtnEmdev.memo),d(a.taiPtnEmdev.nodeUuid,a.taiPtnEmdev.emR3NodeId,a.taiPtnEmdev.emR4NodeId,a.taiPtnEmdev.locationId,t)},error:function(){alert("数据有问题")}})}},".btn-success"),$("#netElementConfig").on({click:function(){var t=$(this).data("id"),a=$(this);return core.confirm("是否确认删除此信息！删除后将无法恢复",function(){$.ajax({type:"DELETE",url:hostUrl+"monitor-api/taiPtnEmdev/deleteTaiPtnEmdev?emId="+t,contentType:"application/json; charset=utf-8",cache:!1,dataType:"json",success:function(t){0==t.code?a.closest("tr").remove():alert(t.message)},error:function(){alert("数据返回有问题")}})}),!1}},".btn-danger")}if($("#netAlarmLog").length){document.title="告警维护日志";var l=hostUrl+"monitor-api/taiPtnActiveFault/getTaiPtnHisFaultInfoList";$.ajax({type:"GET",url:l+"?page=1&rows=10",cache:!1,dataType:"json",success:function(t){var a={id:"example2_paginate",data:l,maxshowpageitem:6,pagelistcount:10,callBack:function(a){for(var e='<thead><tr><th width="100">维护建议</th><th width="242">断电网元</th><th width="auto">关联网元名称</th><th width="150">设备状态</th><th width="155">告警时间</th><th width="155">确认时间</th></tr></thead><tbody>',i=0;i<t.list.length;i++){var o=t.list[i];e+="<tr>",e+="<td>"+o.handleSuggestion+"</td>",e+="<td>"+o.aMeName+"</td>",e+="<td>"+o.meName+"</td>",e+="<td>"+o.switchState+"</td>",e+="<td>"+o.raiseTime+"</td>",e+="<td>"+o.confirmTime+"</td>",e+="</tr>"}e+="</tbody>",$("#example_ajaxForm").html(e)}};page.init(t.total,1,a)},error:function(){alert("数据有问题")}})}var c=/(activeAlarm|netElementList|netElementPort|netElementConfig|netAlarmLog)/.exec(location.href),m={activeAlarm:1,netElementList:2,netElementPort:3,netElementConfig:4,netAlarmLog:5};null==c||""==c?$("#cssmenu li").eq(0).addClass("active"):($("#cssmenu li").removeClass("active"),$("#cssmenu li").eq(m[c[0]]).addClass("active")),$("#email").focus(function(){$("#tit_tip").html("")}),$("#password").focus(function(){$("#tit_tip").html("")}),$("#loginBtn").click(function(){return t($("#email").val())?($("#tit_tip").html("账号不能为空哦！"),!1):t($("#password").val())?($("#tit_tip").html("密码不能为空哦!"),!1):void $.ajax({type:"POST",url:hostUrl+"monitor-api/login/m_v2/userLogin",data:{userName:$("#email").val(),password:$("#password").val()},cache:!1,dataType:"json",success:function(t){0==t.code?window.location.href="/monitor-web/menu/m_v2/alarmSuggestion.html":$("#tit_tip").html(t.message)},error:function(){alert("数据有问题！")}})})});